<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="DiffusionSfM: Predicting Structure and Motion via Ray Origin and Endpoint Diffusion">
  <meta name="keywords" content="Sparse view, reconstruction, diffusion, Structure-from-Motion">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Flow3r: Factored Flow Prediction for Visual Geometry Learning</title>


  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro">
  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">
  <style>
    /* ËÆ©Êï¥‰∏™È°µÈù¢ÁöÑÊâÄÊúâÈÉ®ÂàÜÈÉΩ‰ΩøÁî®80%ÂÆΩÂ∫¶ */
    .container.is-max-desktop {
      max-width: 80% !important;
      width: 80% !important;
    }
    
    .section .container {
      max-width: 80% !important;
      width: 80% !important;
    }
  </style>

  <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/4.0.0/model-viewer.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YXDZHQRVSJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-YXDZHQRVSJ');
</script>

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h2 class="title is-2 publication-title">Flow3r: Factored Flow Prediction for Visual Geometry Learning </h2>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
                <a href="https://kidrauh.github.io/" target="_blank">Zhongxiao Cong</a>,</span>
            <span class="author-block">
              <a href="https://qitaozhao.github.io/" target="_blank">Qitao Zhao</a>,</span>
            <span class="author-block">
              <a href="https://msjeon.me/" target="_blank">Minsik Jeon</a>,</span>
            <span class="author-block">
              <a href="https://shubhtuls.github.io/" target="_blank">Shubham Tulsiani</a></span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block">Carnegie Mellon University</span>
          </div>

          <!-- <div class="is-size-5 publication-authors">
            <span class="author-block">CVPR 2025</span>
          </div> -->

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://www.zhongxiaocong.com/projects/flow3r/paper.pdf" 
                class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <!-- <span class="link-block">
                <a href="https://github.com/QitaoZhao/DiffusionSfM"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span> -->
              <!-- <span class="link-block">
                <a href="https://huggingface.co/spaces/qitaoz/DiffusionSfM"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    ü§ó
                  </span>
                  <span>Demo</span>
                  </a>
              </span> -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- <section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <img src="./projects/flow3r/figures/teaser.png" alt="Teaser figure."/>
      <h5 class="">
        <strong>Flow3r</strong> leverages unlabeled videos via flow supervision for visual geometry learning, enabling more accurate reconstruction in challenging real-world dynamic scenes compared to supervised baselines that can only leverage dense geometry and pose supervision.
      </h5>
    </div>
  </div>
</section> -->


<!-- <section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item item-one">
          <video poster="" id="one" autoplay muted loop playsinline height="100%">
            <source src="./projects/flow3r/videos/backpack_108_12850_22707_N5.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-two">
          <video poster="" id="two" autoplay muted loop playsinline height="100%">
            <source src="./projects/flow3r/videos/habitat_hm3d_train_00512-WZDzPCybQvS_WZDzPCybQvS.basis_N5_4.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-three">
          <video poster="" id="three" autoplay muted loop playsinline height="100%">
            <source src="./projects/flow3r/videos/habitat_gibson_Elmira_N5_2.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-four">
          <video poster="" id="four" autoplay muted loop playsinline height="100%">
            <source src="./projects/flow3r/videos/teddybear_159_17485_33236_N5.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-five">
          <video poster="" id="five" autoplay muted loop playsinline height="100%">
            <source src="./projects/flow3r/videos/bench_250_26758_54244_N5.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>
    </div>
  </div>
</section> -->

<section class="hero teaser" style="padding: 0 0 30px 0; margin-top: -40px;">
    <div class="container fluid">
        <div class="hero-body is-max-widescreen" style="padding-top: 10px;">
            <div class="teaser-container" style="background-color: #f5f7fa; border-radius: 12px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); padding: 40px; max-width: 70%; margin: 0 auto;">
                <center>
                    <video id="teaser" preload="auto" autoplay muted loop playsinline width="100%" style="max-width: 800px; border-radius: 8px; pointer-events: none; box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);">
                        <!-- <source src="./projects/flow3r/videos/teaser_video.MOV" type="video/quicktime"> -->
                        <source src="./projects/flow3r/videos/teaser_video.mp4" type="video/mp4">
                    </video>
                </center>
                <div style="margin-top: 35px; text-align: center; padding: 0 20px;">
                    <p style="font-size: 22px; line-height: 1.6; color: #2c3e50; font-weight: 400; margin: 0;">
                        <strong style="color: #1976d2; font-weight: 600; font-size: 24px;">Flow3r</strong> leverages unlabeled videos via flow supervision for visual geometry learning, enabling more accurate reconstruction in challenging real-world dynamic scenes.
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="section" style="background-color: #f5f5f5;">
    <div class="container is-max-desktop">
      <!-- Abstract. -->
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Abstract</h2>
          <div class="content has-text-justified">
            <p>
              We propose flow3r, a scalable framework for visual geometry learning that leverages flow prediction to guide learning using unlabeled monocular videos. Current 3D/4D reconstruction systems primarily rely on dense geometry and pose supervision, and cannot easily generalize to diverse dynamic real-world scenes. In this work, we propose a mechanism to augment training directly from unlabeled videos, leveraging dense 2D correspondences (or 'flow')  between arbitrary image pairs as supervision.
              Our key insight is that a factored flow prediction module that computes between two images using 'geometry latents' from one image and the 'pose latent' from other can guide visual geometry learning. We first highlight the benefits and scalability of flow supervision in controlled settings and then leverage large-scale unlabeled data to improve off-the-shelf visual geometry models. We evaluate flow3r across diverse 3D benchmarks and demonstrate competitive or state-of-the-art performance, even surpassing supervised models trained with more labeled data.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

<section class="section">
    <div class="container is-max-desktop">
        <div class="columns is-centered has-text-centered">
            <div class="column is-four-fifths">
                <h2 class="title is-3">Results</h2>
            
                <nav>
                    <ul>
                        <li><a id="nav1" href="javascript:void(0);" onclick="showSection('video_4d');setActive('nav1');">Dynamic Scene Reconstruction</a></li>
                        <li><a id="nav2" href="javascript:void(0);" onclick="showSection('video_3d');setActive('nav2');">Egocentric Scene Reconstruction</a></li>
                        <li><a id="nav3" href="javascript:void(0);" onclick="showSection('photo');setActive('nav3');">Interactive Comparisons</a></li>
                    </ul>
                </nav>
                <style>
                    nav ul {
                        list-style: none;
                        display: flex;
                        flex-wrap: nowrap;
                        justify-content: center;
                        gap: 10px;
                        padding: 0;
                        margin: 20px 0;
                    }
                    nav ul li {
                        margin: 0;
                        flex: 1;
                        max-width: 300px;
                    }
                    nav ul li a {
                        display: block;
                        width: 100%;
                        padding: 12px 20px;
                        background-color: #f5f5f5;
                        color: #333;
                        text-decoration: none;
                        border-radius: 5px;
                        border: 1px solid #ddd;
                        transition: all 0.3s ease;
                        cursor: pointer;
                        font-weight: 500;
                        text-align: center;
                        box-sizing: border-box;
                    }
                    nav ul li a:hover {
                        background-color: #e8e8e8;
                        border-color: #bbb;
                    }
                    nav ul li a.active {
                        background-color: #e3f2fd;
                        border-color: #90caf9;
                        color: #1976d2;
                        font-weight: 600;
                    }
                </style>
            </div>
            <script>
                function showSection(sectionId) {
                    // Hide all dynamic sections
                    document.querySelectorAll('.dynamic-section').forEach(function(section) {
                        section.style.display = 'none';
                    });
                    
                    // Show the selected section
                    const section = document.getElementById(sectionId);
                    if (section) {
                        section.style.display = 'block';
                    }
                }
                
                function setActive(activeId) {
                    // Remove 'active' class from all links
                    document.querySelectorAll('nav ul li a').forEach(function(link) {
                        link.classList.remove('active');
                    });
                
                    // Add 'active' class to the clicked link
                    document.getElementById(activeId).classList.add('active');
                }
                
                // Initialize: show first section by default
                document.addEventListener('DOMContentLoaded', function() {
                    showSection('video_4d');
                    setActive('nav1');
                });
                </script>
        </div>
    </div>
    <script defer src="./static/js/nav.js"></script>

    <section id="video_4d" class="section dynamic-section">
        <div class="container is-max-desktop">
            <div class="columns is-centered has-text-centered">
                <div class="column is-full section-panel">
                    <h3 class="title is-4">Dynamic Scene Reconstruction</h3>
                    <div class="carousel-container" style="position: relative; width: 100%; margin: 30px 0;">
                        <button class="carousel-arrow carousel-arrow-left" onclick="slideCarousel(-1)" style="position: absolute; left: -50px; top: 50%; transform: translateY(-50%); background-color: rgba(0, 0, 0, 0.5); color: white; border: none; border-radius: 50%; width: 50px; height: 50px; cursor: pointer; z-index: 10; font-size: 24px; display: flex; align-items: center; justify-content: center; transition: background-color 0.3s;">
                            ‚Äπ
                        </button>
                        <button class="carousel-arrow carousel-arrow-right" onclick="slideCarousel(1)" style="position: absolute; right: -50px; top: 50%; transform: translateY(-50%); background-color: rgba(0, 0, 0, 0.5); color: white; border: none; border-radius: 50%; width: 50px; height: 50px; cursor: pointer; z-index: 10; font-size: 24px; display: flex; align-items: center; justify-content: center; transition: background-color 0.3s;">
                            ‚Ä∫
                        </button>
                        <div class="carousel-wrapper" style="overflow: hidden; width: 100%;">
                            <div class="carousel-track" id="carousel-track" style="display: flex; transition: transform 0.5s ease-in-out;">
                                <!-- Slide 1 -->
                                <div class="carousel-slide" style="min-width: 100%; display: flex; gap: 20px; padding: 0 10px;">
                                    <div class="iframe-container" style="flex: 1; min-width: 0;">
                                        <iframe class="vframe"
                                            src="./projects/flow3r/build/?playbackPath=/projects/flow3r/recordings/basketball.viser&initialCameraPosition=0.0,0.0,-2.0&initialCameraLookAt=0.0,0.0,1.0&baseSpeed=0.8"
                                            loading="lazy"></iframe>
                                    </div>
                                    <div class="iframe-container" style="flex: 1; min-width: 0;">
                                        <iframe class="vframe"
                                            src="./projects/flow3r/build/?playbackPath=/projects/flow3r/recordings/panda.viser&initialCameraPosition=0.0,0.0,-1.0&initialCameraLookAt=0.0,0.0,1.0&baseSpeed=0.8"
                                            loading="lazy"></iframe>
                                    </div>
                                </div>
                                <!-- Slide 2 -->
                                <div class="carousel-slide" style="min-width: 100%; display: flex; gap: 20px; padding: 0 10px;">
                                    <div class="iframe-container" style="flex: 1; min-width: 0;">
                                        <iframe class="vframe"
                                            src="./projects/flow3r/build/?playbackPath=/projects/flow3r/recordings/mall1.viser&initialCameraPosition=0.0,0.0,-2.0&initialCameraLookAt=0.0,0.0,1.0&baseSpeed=0.8"
                                            loading="lazy"></iframe>
                                    </div>
                                    <div class="iframe-container" style="flex: 1; min-width: 0;">
                                        <iframe class="vframe"
                                            src="./projects/flow3r/build/?playbackPath=/projects/flow3r/recordings/mouse.viser&initialCameraPosition=0.0,0.0,-1.0&initialCameraLookAt=0.0,0.0,1.0&baseSpeed=0.8"
                                            loading="lazy"></iframe>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="carousel-indicators" style="display: flex; justify-content: center; gap: 10px; margin-top: 20px;">
                            <span class="carousel-dot active" onclick="goToSlide(0)" style="width: 12px; height: 12px; border-radius: 50%; background-color: #1976d2; cursor: pointer; transition: background-color 0.3s;"></span>
                            <span class="carousel-dot" onclick="goToSlide(1)" style="width: 12px; height: 12px; border-radius: 50%; background-color: #ccc; cursor: pointer; transition: background-color 0.3s;"></span>
                        </div>
                        <div style="text-align: center; margin-top: 15px;">
                            <p style="font-size: 16px; color: #1976d2; font-weight: 600; margin: 0; display: inline-flex; align-items: center; gap: 8px;">
                                <span style="font-size: 20px;">‚Üê</span>
                                <span>Click arrows to view more visualizations</span>
                                <span style="font-size: 20px;">‚Üí</span>
                            </p>
                        </div>
                    </div>
                    <script>
                        let currentSlide = 0;
                        const totalSlides = 2;
                        
                        function slideCarousel(direction) {
                            currentSlide += direction;
                            if (currentSlide < 0) {
                                currentSlide = totalSlides - 1;
                            } else if (currentSlide >= totalSlides) {
                                currentSlide = 0;
                            }
                            updateCarousel();
                        }
                        
                        function goToSlide(index) {
                            currentSlide = index;
                            updateCarousel();
                        }
                        
                        function updateCarousel() {
                            const track = document.getElementById('carousel-track');
                            track.style.transform = `translateX(-${currentSlide * 100}%)`;
                            
                            // Update indicators
                            const dots = document.querySelectorAll('.carousel-dot');
                            dots.forEach((dot, index) => {
                                if (index === currentSlide) {
                                    dot.classList.add('active');
                                    dot.style.backgroundColor = '#1976d2';
                                } else {
                                    dot.classList.remove('active');
                                    dot.style.backgroundColor = '#ccc';
                                }
                            });
                        }
                        
                        // Arrow hover effects
                        document.addEventListener('DOMContentLoaded', function() {
                            const arrows = document.querySelectorAll('.carousel-arrow');
                            arrows.forEach(arrow => {
                                arrow.addEventListener('mouseenter', function() {
                                    this.style.backgroundColor = 'rgba(0, 0, 0, 0.8)';
                                });
                                arrow.addEventListener('mouseleave', function() {
                                    this.style.backgroundColor = 'rgba(0, 0, 0, 0.5)';
                                });
                            });
                        });
                    </script>
                    <br>
                    <!-- <div>
            (Results are downsampled for efficient online rendering)
          </div> -->
                    <div class="hide-on-touchscreens" style="
                        display: flex;
                        justify-content: center;
                        gap: 1.5em;
                        padding-top: 0.5em;
                    ">
                        <div>
                            <i class="ti ti-view-360-arrow"></i> <strong>Left-click</strong> and
                            drag to rotate
                        </div>
                        <div>
                            <i class="ti ti-arrows-move"></i> <strong>Right-click</strong> and
                            drag or
                            <strong>WASD</strong>
                            to move
                        </div>
                        <div><i class="ti ti-zoom"></i> <strong>Scroll</strong> to zoom</div>
                        <div><strong>Click <i class="fas fa-pause"></i></strong> to pause</div>
                    </div>
                    <script>
                        // Get the paragraph element
                        var para = document.getElementById('click-interactive');

                        // Add event listeners for mouse enter and mouse leave
                        para.addEventListener('mouseenter', function () {
                            para.style.fontSize = '22px'; // Increase font size
                            para.style.boxShadow = '0 4px 8px rgba(0,0,0,0.2)'; // Enhance shadow
                        });

                        para.addEventListener('mouseleave', function () {
                            para.style.fontSize = '18px'; // Reset font size
                            para.style.boxShadow = '0 2px 5px rgba(0,0,0,0.1)'; // Reset shadow
                        });
                    </script>
                </div>
            </div>
        </div>
        <style>
            .section-panel {
                background-color: #f5f5f5;
                border-radius: 10px;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                padding: 30px;
                margin: 20px 0;
            }
            
            .visualization-wrapper {
                display: flex;
                flex-wrap: nowrap;
                justify-content: space-between;
                align-items: flex-start;
                gap: 20px;
                width: 100%;
                margin: 30px 0;
            }
            
            .iframe-container {
                flex: 1;
                min-width: 0;
                display: flex;
                flex-direction: column;
                align-items: center;
            }
            
            .iframe-container .vframe {
                width: 100%;
                height: 500px;
                border: none;
                border-radius: 8px;
                box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            }
            
            /* Carousel styles */
            .carousel-container .iframe-container .vframe {
                width: 100%;
                height: 500px;
            }
            
            .carousel-arrow:hover {
                background-color: rgba(0, 0, 0, 0.8) !important;
            }
            
            @media (max-width: 1024px) {
                .carousel-arrow {
                    width: 40px !important;
                    height: 40px !important;
                    font-size: 20px !important;
                }
                .carousel-arrow-left {
                    left: -30px !important;
                }
                .carousel-arrow-right {
                    right: -30px !important;
                }
            }
            
            .iframe-container button {
                margin-top: 15px;
                padding: 10px 20px;
                background-color: #4a90e2;
                color: white;
                border: none;
                border-radius: 5px;
                cursor: pointer;
                font-size: 14px;
                transition: background-color 0.3s ease;
            }
            
            .iframe-container button:hover {
                background-color: #357abd;
            }
            
            @media (max-width: 768px) {
                .visualization-wrapper {
                    flex-direction: column;
                }
                
                .iframe-container .vframe {
                    height: 400px;
                }
            }
        </style>
    </section>

    <section id="video_3d" class="section dynamic-section" style="display: none;">
        <div class="container is-max-desktop">
            <div class="columns is-centered has-text-centered">
                <div class="column is-full section-panel">
                    <h3 class="title is-4">Egocentric Scene Reconstruction</h3>
                    <div id="wrapper" class="visualization-wrapper" style="margin: 30px 0;">
                        <div class="iframe-container">
                            <iframe class="vframe"
                                src="./projects/flow3r/build/?playbackPath=/projects/flow3r/recordings/gopro.viser&initialCameraPosition=0.0,0.0,-3.0&initialCameraLookAt=0.0,0.0,1.0&baseSpeed=0.8"
                                loading="lazy"></iframe>
                        </div>
                        <div class="iframe-container">
                            <iframe class="vframe"
                                src="./projects/flow3r/build/?playbackPath=/projects/flow3r/recordings/epickitchen.viser&initialCameraPosition=0.0,0.0,-3.0&initialCameraLookAt=0.0,0.0,1.0&baseSpeed=0.8"
                                loading="lazy"></iframe>
                        </div>
                    </div>
                    <br>
                    <div class="hide-on-touchscreens" style="
                        display: flex;
                        justify-content: center;
                        gap: 1.5em;
                        padding-top: 0.5em;
                    ">
                        <div>
                            <i class="ti ti-view-360-arrow"></i> <strong>Left-click</strong> and
                            drag to rotate
                        </div>
                        <div>
                            <i class="ti ti-arrows-move"></i> <strong>Right-click</strong> and
                            drag or
                            <strong>WASD</strong>
                            to move
                        </div>
                        <div><i class="ti ti-zoom"></i> <strong>Scroll</strong> to zoom</div>
                        <div><strong>Click <i class="fas fa-pause"></i></strong> to pause</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="photo" class="section dynamic-section" style="display: none;">
        <div class="container is-max-desktop">
            <div class="columns is-centered has-text-centered">
                <div class="column is-full section-panel">
                    <h3 class="title is-4">Interactive Comparisons</h3>
                    <div class="content has-text-justified">
                        <div style="
                        display: grid;
                        grid-template-columns: 1fr 1fr 1fr;
                        gap: 20px;
                        width: 100%;
                        margin: 20px 0;">
                            <div style="
                                display: flex;
                                flex-direction: column;
                                justify-content: center;
                                align-items: center;
                                height: 400px;
                                background: #ffffff;
                                border-radius: 8px;
                                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                                padding: 10px 0;">
                                <model-viewer id="QualitativeResult1"
                                            src="./projects/flow3r/3D/car_flow3r.glb"
                                            alt="3D Model"
                                            loading="eager"
                                            touch-action="pan-y"
                                            environment-image="legacy"
                                            camera-orbit="180deg 70deg auto"
                                            zoom-sensitivity="0.2"
                                            camera-controls
                                            interaction-prompt="none"
                                            render-scale="1"
                                            minimum-render-scale="1"
                                            maximum-render-scale="1"
                                            style="width: 90%; height: 85%; background: #ffffff;">
                                </model-viewer>
                                <div style="margin-top: 6px; font-weight: 600; color: #2c3e50;">Flow3r</div>
                            </div>
                            <div style="
                                display: flex;
                                flex-direction: column;
                                justify-content: center;
                                align-items: center;
                                height: 400px;
                                background: #ffffff;
                                border-radius: 8px;
                                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                                padding: 10px 0;">
                                <model-viewer id="QualitativeResult2"
                                            src="./projects/flow3r/3D/car_vggt.glb"
                                            alt="3D Model"
                                            loading="eager"
                                            touch-action="pan-y"
                                            environment-image="legacy"
                                            camera-orbit="180deg 70deg auto"
                                            zoom-sensitivity="0.2"
                                            camera-controls
                                            interaction-prompt="none"
                                            render-scale="1"
                                            minimum-render-scale="1"
                                            maximum-render-scale="1"
                                            style="width: 90%; height: 85%; background: #ffffff;">
                                </model-viewer>
                                <div style="margin-top: 6px; font-weight: 600; color: #2c3e50;">VGGT</div>
                            </div>
                            <div style="
                                display: flex;
                                flex-direction: column;
                                justify-content: center;
                                align-items: center;
                                height: 400px;
                                background: #ffffff;
                                border-radius: 8px;
                                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                                padding: 10px 0;">
                                <model-viewer id="QualitativeResult3"
                                            src="./projects/flow3r/3D/car_pi3.glb"
                                            alt="3D Model"
                                            loading="eager"
                                            touch-action="pan-y"
                                            environment-image="legacy"
                                            camera-orbit="180deg 70deg auto"
                                            zoom-sensitivity="0.2"
                                            camera-controls
                                            interaction-prompt="none"
                                            render-scale="1"
                                            minimum-render-scale="1"
                                            maximum-render-scale="1"
                                            style="width: 90%; height: 85%; background: #ffffff;">
                                </model-viewer>
                                <div style="margin-top: 6px; font-weight: 600; color: #2c3e50;">Pi3</div>
                            </div>
                        </div>
                        <div class="content has-text-justified" style="display: flex; justify-content: center; margin-top: 20px;">
                            <div class="thumbnail-container" id="thumbnail-qualitative" style="justify-content: center;">
                                <img src="./projects/flow3r/3D/car.png" data-key="car">
                                <img src="./projects/flow3r/3D/cat.png" data-key="cat">
                                <img src="./projects/flow3r/3D/room.png" data-key="room">
                                <img src="./projects/flow3r/3D/kitchen2.png" data-key="kitchen2">
                            </div>  
                        </div>  
                        <style>
                            .thumbnail-container img, .thumbnail-container video {
                                transition: all 0.3s ease;
                                border: 3px solid transparent;
                                cursor: pointer;
                            }
                            .thumbnail-selected {
                                transform: scale(1.2);
                                border: 6px solid #79b4f2 !important; 
                                box-shadow: 0 0 10px rgba(121, 180, 242, 0.5);
                                z-index: 10;
                                position: relative;
                            }
                            
                            /* New styles for responsive horizontal gallery */
                            .thumbnail-container {
                                display: flex;
                                flex-wrap: wrap;
                                gap: 15px;
                                padding: 10px 0;
                                align-items: center;
                                justify-content: center;
                            }
                            
                            @media (max-width: 768px) {
                                .thumbnail-container {
                                    flex-wrap: wrap;
                                }
                            }
                            
                            .thumbnail-container img, 
                            .thumbnail-container video {
                                flex: 0 0 auto;
                                height: auto;
                                width: 200px; /* Consistent width */
                                object-fit: cover;
                                max-width: none;
                            }
                            
                            /* Custom scrollbar styling */
                            .thumbnail-container::-webkit-scrollbar {
                                height: 6px;
                            }
                            
                            .thumbnail-container::-webkit-scrollbar-track {
                                background: #f1f1f1;
                                border-radius: 10px;
                            }
                            
                            .thumbnail-container::-webkit-scrollbar-thumb {
                                background: #888;
                                border-radius: 10px;
                            }
                            
                            .thumbnail-container::-webkit-scrollbar-thumb:hover {
                                background: #555;
                            }
                            
                            /* Adjust for smaller screens */
                            @media (max-width: 768px) {
                                .thumbnail-container img,
                                .thumbnail-container video {
                                    height: 100px;
                                }
                                
                                /* Make model-viewer grid single column on mobile */
                                #photo .content > div[style*="grid-template-columns"] {
                                    grid-template-columns: 1fr !important;
                                }
                            }
                        </style>
                        <script>
                            // Initialize thumbnail selection for photo section
                            document.addEventListener('DOMContentLoaded', function() {
                                // Select first thumbnail by default
                                const firstThumbnail = document.querySelector('#thumbnail-qualitative img:first-child');
                                if (firstThumbnail) {
                                    firstThumbnail.classList.add('thumbnail-selected');
                                }
                                
                                // Get all model-viewers
                                const viewers = [];
                                for (let i = 1; i <= 3; i++) {
                                    const viewer = document.getElementById('QualitativeResult' + i);
                                    if (viewer) {
                                        viewers.push(viewer);
                                    }
                                }
                                
                                // Lock render scale to avoid quality drops during interaction
                                viewers.forEach(viewer => {
                                    if ('renderScale' in viewer) {
                                        viewer.renderScale = 1;
                                    }
                                    if ('minimumRenderScale' in viewer) {
                                        viewer.minimumRenderScale = 1;
                                    }
                                    if ('maximumRenderScale' in viewer) {
                                        viewer.maximumRenderScale = 1;
                                    }
                                });
                                
                                // Flag to prevent circular updates
                                let isUpdating = false;
                                let rafId = null;
                                let activeViewer = null;
                                
                                // Hide interaction prompts on all viewers
                                function updateControlsState() {
                                    viewers.forEach(viewer => {
                                        if (viewer.getAttribute('interaction-prompt') !== 'none') {
                                            viewer.setAttribute('interaction-prompt', 'none');
                                        }
                                    });
                                }
                                
                                // Sync camera from source viewer to all other viewers
                                function syncCamera(sourceViewer) {
                                    if (isUpdating) return;
                                    
                                    // Cancel any pending animation frame
                                    if (rafId) {
                                        cancelAnimationFrame(rafId);
                                    }
                                    
                                    // Use requestAnimationFrame for smooth, fast updates
                                    rafId = requestAnimationFrame(() => {
                                        isUpdating = true;
                                        
                                        try {
                                            // Get camera state from source viewer
                                            const orbit = sourceViewer.getCameraOrbit();
                                            const fieldOfView = sourceViewer.getFieldOfView();
                                            
                                            // Apply to all other viewers
                                            viewers.forEach(viewer => {
                                                if (viewer !== sourceViewer) {
                                                    // Update camera state
                                                    viewer.cameraOrbit = `${orbit.theta}rad ${orbit.phi}rad ${orbit.radius}m`;
                                                    viewer.fieldOfView = `${fieldOfView}deg`;
                                                }
                                            });
                                        } catch (e) {
                                            console.log('Camera sync error:', e);
                                        }
                                        
                                        isUpdating = false;
                                    });
                                }
                                
                                // Add camera-change event listeners to all viewers
                                viewers.forEach((viewer, index) => {
                                    let isInteracting = false;
                                    
                                    // Track when user starts interacting
                                    viewer.addEventListener('mousedown', () => {
                                        isInteracting = true;
                                        activeViewer = viewer;
                                        updateControlsState();
                                    });
                                    
                                    viewer.addEventListener('touchstart', () => {
                                        isInteracting = true;
                                        activeViewer = viewer;
                                        updateControlsState();
                                    });
                                    
                                    viewer.addEventListener('mouseup', () => {
                                        isInteracting = false;
                                        setTimeout(() => {
                                            if (activeViewer === viewer) {
                                                activeViewer = null;
                                                updateControlsState();
                                            }
                                        }, 50);
                                    });
                                    
                                    viewer.addEventListener('touchend', () => {
                                        isInteracting = false;
                                        setTimeout(() => {
                                            if (activeViewer === viewer) {
                                                activeViewer = null;
                                                updateControlsState();
                                            }
                                        }, 50);
                                    });
                                    
                                    // Track mouse leave to handle drag end
                                    viewer.addEventListener('mouseleave', () => {
                                        if (isInteracting && activeViewer === viewer) {
                                            isInteracting = false;
                                            setTimeout(() => {
                                                if (activeViewer === viewer) {
                                                    activeViewer = null;
                                                    updateControlsState();
                                                }
                                            }, 50);
                                        }
                                    });
                                    
                                    // Only sync if this viewer is being actively interacted with
                                    let lastSyncTime = 0;
                                    viewer.addEventListener('camera-change', () => {
                                        if (isInteracting && !isUpdating && activeViewer === viewer) {
                                            const now = performance.now();
                                            // Throttle to ~60fps for smooth but not too frequent updates
                                            if (now - lastSyncTime >= 16) {
                                                lastSyncTime = now;
                                                syncCamera(viewer);
                                            }
                                        }
                                    });
                                });
                                
                                // Initialize controls state
                                updateControlsState();
                                
                                const methods = ['flow3r', 'vggt', 'pi3'];
                                document.querySelectorAll('#thumbnail-qualitative img, #thumbnail-qualitative video').forEach((el, index) => {
                                    el.addEventListener('click', () => {
                                        const baseKey = el.getAttribute('data-key');
                                        
                                        isUpdating = true;
                                        
                                        // Update all three model-viewers with method-specific models
                                        for (let i = 1; i <= 3; i++) {
                                            const modelViewer = document.getElementById('QualitativeResult' + i);
                                            const method = methods[i - 1];
                                            if (modelViewer && baseKey && method) {
                                                modelViewer.setAttribute('src', `./projects/flow3r/3D/${baseKey}_${method}.glb`);
                                                modelViewer.cameraOrbit = "180deg 70deg auto";
                                                modelViewer.resetTurntableRotation(0);
                                                modelViewer.jumpCameraToGoal();
                                            }
                                        }
                                        
                                        setTimeout(() => {
                                            isUpdating = false;
                                        }, 500);

                                        // Remove selection class from all elements
                                        document.querySelectorAll('#thumbnail-qualitative img, #thumbnail-qualitative video').forEach(element => {
                                            element.classList.remove('thumbnail-selected');
                                        });
                                        
                                        // Add selection class to clicked element
                                        el.classList.add('thumbnail-selected');
                                        
                                        // Play video if it's a video element
                                        if (el.tagName.toLowerCase() === 'video') {
                                            el.play();
                                        }
                                        
                                        // Pause all other videos
                                        document.querySelectorAll('#thumbnail-qualitative video').forEach(video => {
                                            if (video !== el) {
                                                video.pause();
                                                video.currentTime = 0;
                                            }
                                        });
                                    });
                                });
                            });
                        </script>
                    </div>
                </div>
            </div>
        </div>
    </section>


<section class="section">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column is-full-width">
          <h2 class="title is-3">How Can Flow Supervise Geometry?</h2>
          <div class="content has-text-justified">
            <p>
                Modern visual-geometry networks first encode each image into patch tokens and a camera token <strong>(a)</strong> using a multi-view transformer backbone. Based on these latent features, there are several ways to predict dense correspondences between frames.
                Traditional correspondence heads <strong>(b)</strong> infer flow directly from patch features, relying purely on visual appearance and ignoring the underlying scene geometry. Alternatively, one may compute flow by explicitly projecting predicted 3D points into another view using decoded camera poses <strong>(c)</strong>; however, this approach assumes static scenes and is highly sensitive to geometric prediction errors. In contrast, our factored flow mechanism <strong>(d)</strong> combines the geometry latents from the source view with the camera latents from the target view and decodes correspondences directly in latent space. This design yields geometry-aware flow, improves robustness, and naturally extends to dynamic scenes.
            </p>
          </div>
          <div class="content has-text-centered">
            <img src="./projects/flow3r/figures/comparison.png" alt="Comparison figure."/>
          </div>
        </div>
      </div>
  </section>

<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Method</h2>
        <div class="content has-text-justified">
          <p>
            Flow3r predicts visual geometry using factored flow supervision, enabling scalable geometry learning from unlabeled videos. Each input image is encoded and processed by the multi-view transformer to produce camera tokens and patch tokens. For data with dense geometry and pose labels, we directly supervise the patch tokens and camera tokens with the corresponding labels. For dynamic datasets, we predict flow between two frames in a factorized manner, supervised by an off-the-shelf 2D flow prediction model UFM<sup><a href="https://arxiv.org/abs/2506.09278">[1]</a></sup>. To obtain the factored flow, we fuse the patch features of one frame with the camera features of the other, and decode the fused representation through the DPT head to produce dense flow predictions.
          </p>
        </div>
        <div class="content has-text-centered">
          <img src="./projects/flow3r/figures/framework.png" alt="Method figure."/>
        </div>
      </div>
    </div>
</section>



<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Results</h2>
        <!-- Subsection. -->
        <h3 class="title is-4">Does Factored Flow Help?</h3>
        <div class="content has-text-justified">
          <p>
            We first compare our factored prediction paradigm against alternative designs and no-flow baselines on static and dynamic scenes.
            We include two  models trained with full 3D supervision with different numbers of training sequences (denoted as 3d-sup and 3d-sup++). Next, building upon the no-flow baseline 3d-sup, we introduce three additional variants that incorporate flow supervision using different formulations: (1) flow-projective, computes flow explicitly from predicted camera poses and pointmaps via projective geometry; (2) flow-tracking,  adopts a VGGT-style tracking head based on pairwise patch features; (3) flow-factored applies our proposed factored flow prediction formulation. 
         </p>
        </div>
        <h4 class="title is-5">Static Scene Results</h4>
        <div class="content has-text-justified">
            <p>
                On ScanNet++, our factored flow prediction model (flow-factored) significantly outperforms the no-flow baseline (3d-sup), while outperforming other alternatives that leverage flow supervision. It even performs highly comparable with the fully-3D-supervised baseline (3d-sup++).
            </p>
          </div>
        <div class="content has-text-centered">
          <img src="./projects/flow3r/figures/result1.png" alt="SPARF Comparison figure." width="75%"/>
        </div>

        <h4 class="title is-5">Dynamic Scene Results</h4>
        <div class="content has-text-justified">
            <p>
                We train seven model variants on OmniWorld and SpatialVID, where OmniWorld provides 3D supervision and SpatialVID offers flow supervision. Consistent with our findings on static scenes, flow-factored with factored flow prediction considerably outperforms the no-flow baseline (3d-sup) and other flow-supervised alternatives. Also, factored flow prediction brings consistent gains by using more data.
            </p>
          </div>
        <div class="content has-text-centered">
          <img src="./projects/flow3r/figures/result2.png" alt="SPARF Comparison figure." width="75%"/>
        </div>
        <!--/ Subsection. -->


        <!-- Subsection. -->
        <h3 class="title is-4">Improving SoTA Models with Unlabeled Data</h3>
        <div class="content has-text-justified">
          <p>
            Here we scale the training of an off-the-shelf large visual geometry network (pi3) by leveraging our factored flow prediction strategy with unlabeled dynamic data. 
            We evaluate performance using pose accuracy and reconstruction metrics in four dynamic datasets (Kinetics700, Epic-Kitchens, Sintel and Bonn) and four static datasets (Co3Dv2, Scannet, NRGBD, and 7-scenes). Best, second and third results are highlighted in light red, orange, and yellow, respectively. Flow3r consistently outperforms state-of-the-art methods in both camera pose estimation and scene reconstruction, demonstrating the effectiveness of leveraging large-scale unlabeled videos for visual geometry learning via factored-flow supervision.
        </p>
        </div>
        <div class="content has-text-centered">
            <img src="./projects/flow3r/figures/result3.png" alt="LEAP Comparison figure." width="100%"/>
            <img src="./projects/flow3r/figures/result4.png" alt="LEAP Comparison figure." width="100%"/>
        </div>

      </div>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop content">
    <h2 class="title is-3">Discussion</h2>
    <p>
        In this work, we present flow3r and demonstrate that it effectively leverages in-the-wild unlabeled data by introducing factored flow prediction, advancing visual geometry learning beyond existing fully supervised methods. While our approach opens up new possibilities, several challenges remain.
    </p>
    <p>
        First, flow3r relies on off-the-shelf models to provide pseudo-ground-truth flow supervision, and there can be domains where such 2D prediction fails, limiting the performance upper bound of flow3r. Second, although our factored flow formulation elegantly handles dynamic scenes and enables flow supervision to improve the learning of both camera motion and scene geometry, flow3r may struggle under complex scenes with multiple moving independently components. 
        Finally, our current experiments operate at a moderate scale (~800K video sequences for flow supervision), and scaling to truly large-scale settings (~10-100M videos) presents an exciting but unexplored direction. While this is out of scope for our work due to computational constraints, we envision flow3r's formulation serving as a building block for future large-scale learning methods.
    </p>
  </div>
</section>


<!-- <section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title is-3">BibTeX</h2>
<pre><code>@inproceedings{zhao2025diffusionsfm,
  title={DiffusionSfM: Predicting Structure and Motion via Ray Origin and Endpoint Diffusion}, 
  author={Qitao Zhao and Amy Lin and Jeff Tan and Jason Y. Zhang and Deva Ramanan and Shubham Tulsiani},
  booktitle={CVPR},
  year={2025} 
}</code></pre>
  </div>
</section> -->


<section class="column" id="Acknowledgements">
  <div class="container is-max-desktop content">
    <h2 class="title is-3">Acknowledgements</h2>
    <p>
        We thank the members of the Physical Perception Lab at CMU for their valuable discussions. 
    </p>
    <p>
        This work was supported by an NVIDIA academic grant. This work used Bridges-2 at Pittsburgh Supercomputing Center through allocation CIS250061 from the Advanced Cyberinfrastructure Coordination Ecosystem: Services & Support (ACCESS) program, which is supported by
        National Science Foundation grants #2138259, #2138286,
        #2138307, #2137603, and #2138296. This work was supported by Intelligence Advanced Research Projects Activity (IARPA) via Department of Interior/Interior Business
        Center (DOI/IBC) contract number 140D0423C0074. The
        U.S. Government is authorized to reproduce and distribute
        reprints for Governmental purposes notwithstanding any
        copyright annotation thereon. Disclaimer: The views and
        conclusions contained herein are those of the authors and
        should not be interpreted as necessarily representing the official policies or endorsements, either expressed or implied,
        of IARPA, DOI/IBC, or the U.S. Government.
    </p>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <!-- <a class="icon-link"
         href="https://arxiv.org/abs/2505.05473">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/QitaoZhao/DiffusionSfM" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a> -->
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is built using this template (<a href="https://github.com/nerfies/nerfies.github.io">source code</a>). The 3D model visualization is adapted from <a href="https://vgg-t.github.io/">VGGT</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>